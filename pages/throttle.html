<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <title>Virtual HOTAS</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.5.0/nouislider.css" rel="stylesheet" />
  <style>
    .grid-container {
      display: grid;
      grid-auto-flow: column;
      gap: 10px;
      height: calc(100vh - 10px);
      padding: 10px;
    }

    .button {
      width: 100px;
      height: 100px;
      font-size: large;
    }

    .slider-container {
      width: 120px;
      height: calc(100% - 40px);
      padding-top: 20px;
      padding-bottom: 20px;
    }

    #throttleSlider {
      height: 100%;
      width: 50px;
    }

    #throttleSlider .noUi-handle {
      height: 50px;
      width: 100px;
      right: -25px;
    }

    #throttleSlider .noUi-handle::after {
      display: none;
    }

    #throttleSlider .noUi-handle::before {
      display: none;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.5.0/nouislider.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>

<body>
  <div class="grid-container">
    <div style="display: grid;">
      <button style="height: 100px" class="btn button" onpointerdown="buttonPress(2)" onpointerup="buttonRelease(2)">AT ff</button>
      <button style="height: 100px" class="btn button" onpointerdown="buttonPress(14)"
        onpointerup="buttonRelease(14)">camera up</button>
      <button style="height: 100px" class="btn button" onpointerdown="buttonPress(18)"
        onpointerup="buttonRelease(18)">camera down</button>
    </div>
    <button class="item-btn6 btn btn-primary button" onpointerdown="toggleFullscreen()">
      Full Screen
    </button>
    <div class="item-throttle">
      <p><b>Throttle</b></p>
      <div class="slider-container">
        <div id="throttleSlider"></div>
      </div>
    </div>
  </div>

  <script>
    // Initialize the socket
    const socket = io.connect("http://" + document.domain + ":" + location.port);

    let buttonValuesInit = Array(0).fill(0);
    let orientationInit = Array(5).fill(0);
    socket.emit("name", 'throttle')

    document.addEventListener("DOMContentLoaded", function () {
      const verticalSlider_throttle = document.getElementById("throttleSlider");
      noUiSlider.create(verticalSlider_throttle, {
        start: 1,
        orientation: "vertical",
        connect: "lower",
        direction: "rtl",
        tooltips: {
          to: function (value) {
            return Math.round((value / 32768) * 100);
          },
        },
        range: {
          min: 1,
          max: 32768,
        },
      });
      verticalSlider_throttle.noUiSlider.on("update", function (values, handle, unencoded) {
        socket.emit("throttle", Number(values[handle]));
      });
    });

    function buttonPress(data) {
      socket.emit("button_press", data);
    }

    function buttonRelease(data) {
      socket.emit("button_release", data);
    }
    

    function toggleFullscreen() {
      if (document.fullscreenElement) {
        document.exitFullscreen().catch((err) => console.log(err));
      } else {
        document.documentElement.requestFullscreen().catch((err) => console.log(err));
      }
    }
  </script>
</body>

</html>